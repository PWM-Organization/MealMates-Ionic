<ion-content [fullscreen]="true" class="landing-content">
  <!-- Refresher para actualizar contenido -->
  <ion-refresher slot="fixed" (ionRefresh)="handleRefresh($event)">
    <ion-refresher-content
      pullingIcon="chevron-down-circle-outline"
      pullingText="Desliza para actualizar"
      refreshingSpinner="circles"
      refreshingText="Actualizando..."
    ></ion-refresher-content>
  </ion-refresher>

  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-background">
      <div class="hero-overlay"></div>
      <div class="hero-content">
        <div class="logo-section">
          <ion-icon name="restaurant" class="hero-logo"></ion-icon>
          <h1 class="hero-title">MealMates</h1>
          <p class="hero-subtitle">Tu compañero culinario perfecto</p>
        </div>

        <!-- Features Grid -->
        <div class="features-grid">
          <ion-card *ngFor="let feature of heroFeatures" class="feature-card">
            <ion-card-content>
              <ion-icon [name]="feature.icon" class="feature-icon"></ion-icon>
              <h3>{{ feature.title }}</h3>
              <p>{{ feature.description }}</p>
            </ion-card-content>
          </ion-card>
        </div>

        <!-- CTA Buttons -->
        <div class="cta-buttons">
          <ion-button expand="block" fill="solid" (click)="goToRegister()" class="primary-button">
            <ion-icon name="person-add" slot="start"></ion-icon>
            Comenzar Gratis
          </ion-button>
          <ion-button expand="block" fill="outline" (click)="goToLogin()" class="secondary-button">
            <ion-icon name="log-in" slot="start"></ion-icon>
            Iniciar Sesión
          </ion-button>
        </div>
      </div>
    </div>
  </section>

  <!-- Categorías Populares -->
  <section class="categories-section ion-padding">
    <div class="section-header">
      <h2>Explora por Categorías</h2>
      <p>Descubre recetas organizadas por momento del día</p>
    </div>

    <div class="categories-grid">
      <ion-card *ngFor="let category of popularCategories" class="category-card" button (click)="goToLogin()">
        <ion-card-content>
          <ion-icon [name]="category.icon" [color]="category.color" class="category-icon"></ion-icon>
          <h3>{{ category.name }}</h3>
        </ion-card-content>
      </ion-card>
    </div>
  </section>

  <!-- Recetas Destacadas con Carrusel -->
  <section class="featured-section">
    <div class="section-header ion-padding">
      <h2>Recetas Destacadas</h2>
      <p>Las favoritas de nuestra comunidad</p>
    </div>

    <div *ngIf="isLoading()" class="loading-container">
      <ion-spinner name="crescent" color="primary"></ion-spinner>
      <p>Cargando recetas deliciosas...</p>
    </div>

    <div *ngIf="!isLoading() && featuredRecipes().length > 0">
      <!-- Slides con recetas -->
      <ion-slides
        #slides
        [options]="{ 
          slidesPerView: 1.2, 
          spaceBetween: 16, 
          centeredSlides: true,
          breakpoints: {
            576: { slidesPerView: 2.2 },
            768: { slidesPerView: 3.2 }
          }
        }"
        class="recipes-slides"
        (ionSlideDidChange)="onSlideChange()"
      >
        <ion-slide *ngFor="let recipe of featuredRecipes()">
          <ion-card class="recipe-card" button (click)="openRecipeModal(recipe)">
            <div class="recipe-image-container">
              <img [src]="recipe.imageUrl" [alt]="recipe.title" class="recipe-image" />
              <div class="recipe-rating">
                <ion-icon name="star" color="warning"></ion-icon>
                <span>{{ recipe.rating || 4.5 }}</span>
              </div>
            </div>

            <ion-card-content class="recipe-content">
              <h3>{{ recipe.title }}</h3>
              <p>{{ recipe.description }}</p>

              <div class="recipe-meta">
                <ion-chip [color]="getDifficultyColor(recipe.difficulty)" outline size="small">
                  <ion-icon name="speedometer" size="small"></ion-icon>
                  <ion-label>{{ recipe.difficulty }}</ion-label>
                </ion-chip>

                <ion-chip color="medium" outline size="small">
                  <ion-icon name="time" size="small"></ion-icon>
                  <ion-label>{{ recipe.cookingTime }}min</ion-label>
                </ion-chip>
              </div>

              <div class="recipe-stats">
                <div class="stat">
                  <ion-icon name="heart" color="danger"></ion-icon>
                  <span>{{ recipe.likes }}</span>
                </div>
                <div class="stat">
                  <ion-icon name="bookmark" color="primary"></ion-icon>
                  <span>{{ recipe.saves }}</span>
                </div>
              </div>
            </ion-card-content>
          </ion-card>
        </ion-slide>
      </ion-slides>
    </div>

    <!-- Mensaje si no hay recetas -->
    <div *ngIf="!isLoading() && featuredRecipes().length === 0" class="empty-state ion-padding">
      <ion-icon name="restaurant-outline" size="large" color="medium"></ion-icon>
      <h3>Próximamente...</h3>
      <p>Estamos preparando increíbles recetas para ti</p>
      <ion-button fill="clear" (click)="handleRefresh({ target: { complete: () => {} } })">
        <ion-icon name="refresh" slot="start"></ion-icon>
        Actualizar
      </ion-button>
    </div>
  </section>

  <!-- Call to Action Final -->
  <section class="final-cta-section ion-padding">
    <ion-card class="cta-card">
      <ion-card-content>
        <div class="cta-content">
          <h2>¿Listo para cocinar?</h2>
          <p>Únete a miles de cocineros que ya disfrutan de MealMates</p>

          <div class="cta-stats">
            <div class="stat-item">
              <h3>1000+</h3>
              <p>Recetas</p>
            </div>
            <div class="stat-item">
              <h3>5000+</h3>
              <p>Usuarios</p>
            </div>
            <div class="stat-item">
              <h3>4.8</h3>
              <p>Calificación</p>
            </div>
          </div>

          <ion-button expand="block" size="large" (click)="goToRegister()" class="join-button">
            <ion-icon name="rocket" slot="start"></ion-icon>
            Unirse Ahora
          </ion-button>
        </div>
      </ion-card-content>
    </ion-card>
  </section>

  <!-- Footer -->
  <ion-footer class="landing-footer">
    <ion-toolbar>
      <div class="footer-content">
        <p>&copy; 2024 MealMates. Hecho con ❤️ para amantes de la cocina</p>
        <div class="footer-links">
          <ion-button fill="clear" size="small" (click)="goToLogin()"> Iniciar Sesión </ion-button>
          <ion-button fill="clear" size="small" (click)="goToRegister()"> Registrarse </ion-button>
        </div>
      </div>
    </ion-toolbar>
  </ion-footer>
</ion-content>

<!-- Modal de Detalle de Receta -->
<ion-modal #recipeModal [isOpen]="false" class="recipe-modal">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>{{ selectedRecipe()?.title }}</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="closeRecipeModal()">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content class="modal-content" *ngIf="selectedRecipe()">
      <div class="modal-recipe-image">
        <img [src]="selectedRecipe()!.imageUrl" [alt]="selectedRecipe()!.title" />
        <div class="modal-recipe-overlay">
          <div class="modal-recipe-rating">
            <ion-icon name="star" color="warning"></ion-icon>
            <span>{{ selectedRecipe()!.rating || 4.5 }}</span>
          </div>
        </div>
      </div>

      <div class="modal-recipe-content ion-padding">
        <h2>{{ selectedRecipe()!.title }}</h2>
        <p>{{ selectedRecipe()!.description }}</p>

        <div class="modal-recipe-meta">
          <ion-chip [color]="getDifficultyColor(selectedRecipe()!.difficulty)">
            <ion-icon name="speedometer"></ion-icon>
            <ion-label>{{ selectedRecipe()!.difficulty }}</ion-label>
          </ion-chip>

          <ion-chip color="primary">
            <ion-icon name="time"></ion-icon>
            <ion-label>{{ selectedRecipe()!.cookingTime }} min</ion-label>
          </ion-chip>

          <ion-chip color="secondary">
            <ion-icon name="people"></ion-icon>
            <ion-label>{{ selectedRecipe()!.servings }} porciones</ion-label>
          </ion-chip>
        </div>

        <div class="modal-recipe-stats">
          <div class="stat">
            <ion-icon name="heart" color="danger"></ion-icon>
            <span>{{ selectedRecipe()!.likes }} me gusta</span>
          </div>
          <div class="stat">
            <ion-icon name="bookmark" color="primary"></ion-icon>
            <span>{{ selectedRecipe()!.saves }} guardadas</span>
          </div>
        </div>

        <!-- Call to action para ver más -->
        <div class="modal-cta">
          <p>Para ver la receta completa y guardar en favoritos:</p>
          <ion-button expand="block" fill="solid" (click)="goToRegister()">
            <ion-icon name="person-add" slot="start"></ion-icon>
            Registrarse Gratis
          </ion-button>
          <ion-button expand="block" fill="outline" (click)="goToLogin()">
            <ion-icon name="log-in" slot="start"></ion-icon>
            Ya tengo cuenta
          </ion-button>
        </div>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>
